<!DOCTYPE html>
<html>
<head>
    <title>MCN | Premium GAC Toolkit</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --mcn-navy: #0A2342;
            --mcn-blue: #0056b3;
            --mcn-light: #f0f4f8; 
            --auth-purple: #7c3aed;
            --success-green: #059669;
            --joyful-orange: #f59e0b;
            --white: #ffffff;
            --text-dark: #0f172a;
            --text-muted: #475569;
            --border-light: #e2e8f0;
            --shadow-soft: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
            --shadow-float: 0 20px 40px -10px rgba(0, 86, 179, 0.1), 0 10px 20px -5px rgba(0, 0, 0, 0.04);
        }

        body {
            font-family: 'Plus Jakarta Sans', system-ui, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e0eafc 100%);
            margin: 0;
            padding: 50px 20px;
            color: var(--text-dark);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased; 
        }

        .bg-shapes {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1; overflow: hidden; pointer-events: none; 
        }
        .bg-shape {
            position: absolute; opacity: 0.04; will-change: transform; animation: float 20s infinite ease-in-out alternate;
        }
        .bg-shape:nth-child(1) { top: -2%; left: 5%; width: 250px; animation-delay: 0s; }
        .bg-shape:nth-child(2) { top: 15%; right: 3%; width: 300px; animation-delay: -5s; }
        .bg-shape:nth-child(3) { bottom: 5%; left: 8%; width: 220px; animation-delay: -10s; }
        .bg-shape:nth-child(4) { bottom: -5%; right: 10%; width: 280px; animation-delay: -15s; }
        .bg-shape:nth-child(5) { top: 45%; left: 25%; width: 180px; animation-delay: -7s; }
        .bg-shape:nth-child(6) { top: 55%; right: 25%; width: 160px; animation-delay: -12s; }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(30px) rotate(8deg); }
        }

        .container {
            max-width: 1050px; margin: 0 auto; background: var(--white); border-radius: 32px; box-shadow: var(--shadow-float); border: 1px solid rgba(255, 255, 255, 0.9); transition: transform 0.4s ease;
        }

        .header {
            background: linear-gradient(135deg, var(--mcn-navy) 0%, #003b82 100%);
            padding: 55px 20px; text-align: center; color: var(--white); border-bottom: 6px solid #38bdf8; border-radius: 32px 32px 0 0; position: relative; overflow: hidden;
        }
        .header::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: radial-gradient(circle, rgba(56,189,248,0.15) 0%, transparent 60%);
            pointer-events: none;
        }

        .logo-container {
            background: var(--white); padding: 22px 45px; display: inline-block; border-radius: 24px; box-shadow: 0 15px 35px -5px rgba(0, 0, 0, 0.2); margin-bottom: 25px; transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); position: relative; z-index: 2;
        }
        .logo-container:hover { transform: translateY(-5px) scale(1.02); }
        .logo-img { max-width: 250px; height: auto; display: block; }

        .header h1 { margin: 0; font-size: 38px; font-weight: 800; letter-spacing: -1px; position: relative; z-index: 2; }
        .header p { margin: 12px 0 0; opacity: 0.9; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; font-size: 13px; color: #bae6fd; position: relative; z-index: 2; }

        .setup-grid {
            padding: 45px 50px; background: var(--white); display: grid; grid-template-columns: 1fr 130px 110px 160px; gap: 20px; align-items: flex-end; border-bottom: 1px solid var(--border-light);
        }

        .field-group label { display: block; font-size: 13px; font-weight: 800; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 12px; color: var(--mcn-blue); }
        input, select { 
            width: 100%; padding: 18px 20px; border: 2px solid var(--border-light); border-radius: 16px; font-size: 16px; background: #f8fafc; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-sizing: border-box; color: var(--text-dark); font-weight: 500; font-family: inherit;
        }
        input:focus, select:focus { border-color: #38bdf8; outline: none; background: var(--white); box-shadow: 0 0 0 5px rgba(56, 189, 248, 0.15); transform: translateY(-2px); }

        .btn-primary { background: linear-gradient(135deg, var(--mcn-blue), #2563eb); color: var(--white); border: none; padding: 18px; border-radius: 16px; font-weight: 800; font-size: 15px; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); text-transform: uppercase; letter-spacing: 1px; width: 100%; box-shadow: 0 10px 20px -5px rgba(37, 99, 235, 0.3); font-family: inherit; }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 15px 25px -5px rgba(37, 99, 235, 0.4); }

        .btn-download-draft { background: linear-gradient(135deg, #6366f1, var(--auth-purple)); color: var(--white); border: none; padding: 18px; border-radius: 16px; font-weight: 800; font-size: 15px; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); text-transform: uppercase; letter-spacing: 1px; width: 100%; box-shadow: 0 10px 20px -5px rgba(99, 102, 241, 0.3); font-family: inherit; }
        .btn-download-draft:hover { transform: translateY(-3px); box-shadow: 0 15px 25px -5px rgba(99, 102, 241, 0.4); }

        #displayArea { padding: 50px; }

        .onboarding-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 30px; margin-top: 45px; text-align: left; }
        .onboard-card { background: var(--white); padding: 40px; border-radius: 24px; border: 1px solid var(--border-light); box-shadow: var(--shadow-soft); transition: all 0.3s ease; position: relative; overflow: hidden; }
        .onboard-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(90deg, var(--mcn-blue), #38bdf8); opacity: 0; transition: 0.3s; }
        .onboard-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-float); }
        .onboard-card:hover::before { opacity: 1; }
        .onboard-card h4 { margin: 0 0 20px 0; color: var(--mcn-navy); font-size: 22px; font-weight: 800; display: flex; align-items: center; gap: 12px; }
        .onboard-card ul, .onboard-card ol { margin: 0; padding-left: 22px; color: var(--text-muted); font-size: 15px; line-height: 1.8; }
        .onboard-card li { margin-bottom: 15px; }
        .onboard-card li strong { color: var(--text-dark); font-weight: 700; }

        .impact-card { 
            background: var(--white); border-radius: 20px; padding: 35px; margin-bottom: 25px; border: 1px solid var(--border-light); border-left: 6px solid #38bdf8; box-shadow: var(--shadow-soft); transition: all 0.3s ease; 
        }
        .impact-card:hover { box-shadow: var(--shadow-float); transform: translateX(4px); border-left-color: var(--mcn-blue); }
        
        .card-label { font-size: 16px; font-weight: 700; color: var(--mcn-navy); line-height: 1.6; margin-bottom: 15px; display: block; border-bottom: 1px solid var(--border-light); padding-bottom: 12px; }
        .card-value { font-size: 17px; line-height: 1.8; color: var(--text-dark); white-space: pre-wrap; font-weight: 400; }
        .card-value a { color: var(--mcn-blue); text-decoration: none; font-weight: 600; border-bottom: 2px solid #bae6fd; transition: 0.2s; word-break: break-all; padding-bottom: 2px; }
        .card-value a:hover { color: var(--mcn-navy); border-bottom-color: var(--mcn-navy); background: #f0f9ff; }

        .auth-suite { background: linear-gradient(135deg, #f8fafc, #ffffff); border: 1px solid var(--border-light); border-left: 6px solid var(--auth-purple); padding: 35px 40px; border-radius: 24px; margin: 10px 50px 40px 50px; display: flex; align-items: center; justify-content: space-between; box-shadow: var(--shadow-soft); display: none; }
        .auth-text h3 { margin: 0 0 8px 0; color: var(--auth-purple); font-size: 22px; font-weight: 800; letter-spacing: -0.5px;}
        .auth-text p { margin: 0; color: var(--text-muted); font-size: 15px; }
        .btn-auth { background: var(--auth-purple); color: var(--white); border: none; padding: 16px 28px; border-radius: 16px; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 8px 15px -5px rgba(139, 92, 246, 0.3); font-family: inherit; }
        .btn-auth:hover { background: #6d28d9; transform: translateY(-3px); box-shadow: 0 12px 20px -5px rgba(139, 92, 246, 0.4); }

        .nav-buttons { display: flex; justify-content: space-between; margin: 0 50px 40px 50px; padding-top: 35px; border-top: 1px solid var(--border-light); display: none; }
        .nav-btn { background: var(--white); color: var(--text-dark); border: 2px solid var(--border-light); padding: 16px 35px; border-radius: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; width: 48%; text-transform: uppercase; letter-spacing: 1px; box-shadow: var(--shadow-soft); font-family: inherit; }
        .nav-btn:hover { border-color: var(--text-muted); transform: translateY(-2px); box-shadow: var(--shadow-float); }

        .eval-board { background: var(--white); padding: 50px; border-radius: 32px; margin: 0 50px 50px 50px; display: none; border: 1px solid var(--border-light); box-shadow: var(--shadow-soft); position: relative; overflow: hidden; }
        .eval-board::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 6px; background: linear-gradient(90deg, var(--mcn-navy), #38bdf8); }
        
        .eval-row { background: #f8fafc; border: 1px solid var(--border-light); border-radius: 20px; padding: 25px 30px; margin-bottom: 20px; display: flex; flex-direction: column; gap: 15px; transition: 0.3s ease; }
        .eval-row:hover { border-color: #bae6fd; background: var(--white); box-shadow: var(--shadow-soft); transform: translateY(-2px); }
        .eval-q-text { font-size: 16px; font-weight: 700; color: var(--text-dark); line-height: 1.6; }
        .eval-input { width: 100%; max-width: 500px; padding: 15px 20px; border: 2px solid var(--border-light); border-radius: 12px; font-size: 15px; font-weight: 600; color: var(--mcn-navy); background: var(--white); transition: 0.3s; cursor: pointer; }
        .eval-input:focus { border-color: #38bdf8; outline: none; box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.15); }
        .eval-textarea { width: 100%; height: 110px; padding: 15px 20px; border: 2px solid var(--border-light); border-radius: 12px; font-size: 15px; font-family: inherit; background: var(--white); transition: 0.3s; resize: vertical; line-height: 1.6; }
        .eval-textarea:focus { border-color: #38bdf8; outline: none; box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.15); }

        .btn-copy { background: linear-gradient(135deg, var(--success-green), #047857); color: var(--white); border: none; padding: 22px; border-radius: 16px; font-weight: 800; cursor: pointer; width: 100%; text-transform: uppercase; letter-spacing: 1.5px; transition: all 0.3s ease; box-shadow: 0 10px 20px -5px rgba(16, 185, 129, 0.3); margin-top: 25px; font-size: 16px; font-family: inherit; }
        .btn-copy:hover { transform: translateY(-3px); box-shadow: 0 15px 25px -5px rgba(16, 185, 129, 0.4); }

        .btn-draft { background: linear-gradient(135deg, var(--joyful-orange), #d97706); color: var(--white); border: none; padding: 22px; border-radius: 16px; font-weight: 800; cursor: pointer; width: 100%; text-transform: uppercase; letter-spacing: 1.5px; transition: all 0.3s ease; margin-top: 15px; box-shadow: 0 10px 20px -5px rgba(245, 158, 11, 0.3); font-size: 16px; font-family: inherit; }
        .btn-draft:hover { transform: translateY(-3px); box-shadow: 0 15px 25px -5px rgba(245, 158, 11, 0.4); }
        
        .btn-pdf { background: linear-gradient(135deg, #ef4444, #b91c1c); color: var(--white); border: none; padding: 22px; border-radius: 16px; font-weight: 800; cursor: pointer; width: 100%; text-transform: uppercase; letter-spacing: 1.5px; transition: all 0.3s ease; margin-top: 15px; box-shadow: 0 10px 20px -5px rgba(239, 68, 68, 0.3); font-size: 16px; font-family: inherit; }
        .btn-pdf:hover { transform: translateY(-3px); box-shadow: 0 15px 25px -5px rgba(239, 68, 68, 0.4); }

        /* --- THE PROFESSIONAL FOOTER --- */
        .footer {
            margin: 50px auto 0 auto; max-width: 1050px; padding: 40px 50px; background: rgba(255, 255, 255, 0.8); border-radius: 32px; border: 1px solid var(--border-light); box-shadow: var(--shadow-soft); text-align: center; line-height: 1.8;
        }
        .footer-credit { font-size: 16px; font-weight: 800; color: var(--mcn-navy); margin-bottom: 5px; }
        .footer-sub { font-size: 14px; color: var(--text-muted); font-weight: 500; margin-bottom: 20px; }
        .footer-links { margin-bottom: 25px; }
        .footer-links a { color: var(--mcn-blue); text-decoration: none; font-weight: 700; font-size: 14px; margin: 0 15px; text-transform: uppercase; letter-spacing: 1px; transition: 0.2s; padding-bottom: 4px; border-bottom: 2px solid transparent; }
        .footer-links a:hover { border-bottom-color: var(--mcn-blue); color: var(--mcn-navy); }
        .footer-disclaimer { font-size: 13px; color: #92400e; background: #fffbeb; padding: 20px 30px; border-radius: 16px; border: 1px solid #fde68a; max-width: 800px; margin: 0 auto; text-align: left; }

        .btn-toggle-rubric { position: fixed; right: -5px; top: 50%; transform: translateY(-50%); background: linear-gradient(135deg, #8b5cf6, #6d28d9); color: white; padding: 18px 25px 18px 20px; border-radius: 20px 0 0 20px; border: none; font-weight: 800; font-size: 14px; cursor: pointer; box-shadow: -5px 5px 20px rgba(109, 40, 217, 0.25); z-index: 1000; transition: 0.3s ease; text-transform: uppercase; letter-spacing: 1.5px; writing-mode: vertical-rl; text-orientation: mixed; font-family: inherit; }
        .btn-toggle-rubric:hover { padding-right: 35px; background: #5b21b6; }
        .rubric-panel { position: fixed; top: 0; right: -700px; width: 650px; height: 100vh; background: #ffffff; box-shadow: -15px 0 40px rgba(0, 0, 0, 0.08); z-index: 1001; transition: right 0.4s cubic-bezier(0.16, 1, 0.3, 1); overflow-y: auto; border-left: 1px solid var(--border-light); }
        .rubric-panel.open { right: 0; }

        .btn-toggle-ai { position: fixed; left: -5px; top: 50%; transform: translateY(-50%); background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 18px 20px 18px 25px; border-radius: 0 20px 20px 0; border: none; font-weight: 800; font-size: 14px; cursor: pointer; box-shadow: 5px 5px 20px rgba(217, 119, 6, 0.25); z-index: 1000; transition: 0.3s ease; text-transform: uppercase; letter-spacing: 1.5px; writing-mode: vertical-rl; text-orientation: mixed; font-family: inherit; }
        .btn-toggle-ai:hover { padding-left: 35px; background: #b45309; }
        .ai-panel { position: fixed; top: 0; left: -700px; width: 650px; height: 100vh; background: #ffffff; box-shadow: 15px 0 40px rgba(0, 0, 0, 0.08); z-index: 1001; transition: left 0.4s cubic-bezier(0.16, 1, 0.3, 1); overflow-y: auto; border-right: 1px solid var(--border-light); }
        .ai-panel.open { left: 0; }

        .drawer-header { color: white; padding: 35px; position: sticky; top: 0; z-index: 10; display: flex; justify-content: space-between; align-items: center; }
        .rubric-header { background: linear-gradient(135deg, var(--mcn-navy), var(--mcn-blue)); }
        .ai-header { background: linear-gradient(135deg, #d97706, #b45309); }
        .drawer-header h2 { margin: 0; font-size: 20px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; line-height: 1.4; }
        .close-drawer { background: none; border: none; color: white; font-size: 32px; cursor: pointer; transition: 0.2s; padding: 0; line-height: 1; }
        .close-drawer:hover { color: #cbd5e1; transform: scale(1.1); }
        .rubric-content { padding: 40px 35px; color: var(--text-dark); }
        .rubric-section { margin-bottom: 40px; border-bottom: 1px solid var(--border-light); padding-bottom: 25px; }
        .rubric-section h4 { color: var(--mcn-navy); font-size: 19px; margin: 0 0 20px 0; text-transform: uppercase; letter-spacing: 1px; border-left: 5px solid var(--mcn-blue); padding-left: 12px; font-weight: 800; }
        .ai-section h4 { color: #92400e; border-left-color: #f59e0b; }
        .rubric-rule { background: #f8fafc; padding: 20px; border-radius: 12px; margin-bottom: 15px; border: 1px solid var(--border-light); border-left: 4px solid #38bdf8; }
        .score-badge { font-weight: 800; padding: 4px 10px; border-radius: 6px; display: inline-block; margin-right: 10px; color: white; min-width: 65px; text-align: center; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px; }
        .s5 { background: #10b981; } 
        .s4 { background: #34d399; color: #064e3b; } 
        .s3 { background: #fbbf24; color: #78350f; } 
        .s2 { background: #f87171; color: #7f1d1d; } 
        .s1 { background: #dc2626; } 
        .s-yn { background: var(--auth-purple); } 
        .ai-table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 14px; margin-bottom: 20px; background: white; border-radius: 12px; overflow: hidden; border: 1px solid var(--border-light); }
        .ai-table th { background: #fef3c7; color: #92400e; text-align: left; padding: 15px; border-bottom: 1px solid var(--border-light); font-weight: 800; }
        .ai-table td { padding: 15px; border-bottom: 1px solid var(--border-light); vertical-align: top; line-height: 1.6; border-right: 1px solid var(--border-light); }
        .ai-table td:last-child { border-right: none; }
        .ai-table tr:last-child td { border-bottom: none; }
        .ai-table-footer td { font-weight: 600; background: #fffbeb; font-style: italic; color: #b45309; }
    </style>
</head>
<body>

<div class="bg-shapes">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Sustainable_Development_Goal_01.svg/500px-Sustainable_Development_Goal_01.svg.png" class="bg-shape" alt="SDG 1">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/Sustainable_Development_Goal_04.svg/500px-Sustainable_Development_Goal_04.svg.png" class="bg-shape" alt="SDG 4">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Sustainable_Development_Goal_05.svg/500px-Sustainable_Development_Goal_05.svg.png" class="bg-shape" alt="SDG 5">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/22/Sustainable_Development_Goal_10.svg/500px-Sustainable_Development_Goal_10.svg.png" class="bg-shape" alt="SDG 10">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/Sustainable_Development_Goal_13.svg/500px-Sustainable_Development_Goal_13.svg.png" class="bg-shape" alt="SDG 13">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Sustainable_Development_Goal_17.svg/500px-Sustainable_Development_Goal_17.svg.png" class="bg-shape" alt="SDG 17">
</div>

<button class="btn-toggle-ai" onclick="toggleAiPolicy()" id="btnAiToggle">View AI Policy</button>
<div class="ai-panel" id="aiPanel">
    <div class="drawer-header ai-header">
        <h2>Global Admissions Committee 2026<br>AI Use Policy Guide</h2>
        <button class="close-drawer" onclick="toggleAiPolicy()">√ó</button>
    </div>
    <div class="rubric-content">
        <div class="rubric-section ai-section">
            <div class="rubric-rule ai-rule" style="background: white;">
                <p>The MCN Admissions Team acknowledges that artificial intelligence tools are widely accessible and commonly used by students for writing support. This policy does not prohibit the responsible use of such tools. Instead, it establishes clear boundaries to ensure that all submitted applications reflect the applicant‚Äôs own thinking, experiences, and ideas.</p>
                <p><strong>‚úÖ AI may be used as a supplementary editing tool.</strong> Acceptable uses include correcting grammar, improving clarity, refining sentence flow, or adjusting structure.</p>
                <p><strong>‚ùå AI may not be used to generate the substance of an application.</strong> This includes developing project ideas, constructing arguments, producing reflections, or shaping the intellectual core of responses.</p>
            </div>
        </div>

        <div class="rubric-section ai-section">
            <h4>Decision Framework</h4>
            <div class="rubric-rule ai-rule" style="background: white;">
                <p>For each application, reviewers must select one of the following four options in the review sheet:</p>
                <ol style="font-size: 14px; line-height: 1.8; color: var(--text-dark);">
                    <li><strong>Option 1:</strong> Yes, the responses seem completely AI-generated and the ideas seem unoriginal.</li>
                    <li><strong>Option 2:</strong> Yes, AI has been used for the majority of the application but only to enhance language and grammar; the ideas seem original.</li>
                    <li><strong>Option 3:</strong> Yes, AI has been used for a short portion of the application but only to enhance language and grammar; the ideas seem original.</li>
                    <li><strong>Option 4:</strong> No, the student‚Äôs responses seem completely original without any apparent use of AI.</li>
                </ol>
            </div>
        </div>

        <div class="rubric-section ai-section">
            <h4>Red Flags and Green Flags</h4>
            <table class="ai-table">
                <tr>
                    <th>Green Flags ‚Äî Likely Editing Only</th>
                    <th>Red Flags ‚Äî Likely Substantive Reliance</th>
                </tr>
                <tr>
                    <td>Clear references to personal experiences, communities, or institutions.</td>
                    <td>Repeated restatement of the same idea using different synonyms without adding depth.</td>
                </tr>
                <tr>
                    <td>Specific examples with concrete details rather than abstract descriptions.</td>
                    <td>Overuse of broad, vague, abstract terminology without specific examples.</td>
                </tr>
                <tr>
                    <td>Natural variation in tone and structure across responses.</td>
                    <td>Lack of personal voice, local context, or concrete detail</td>
                </tr>
            </table>
        </div>
    </div>
</div>

<button class="btn-toggle-rubric" onclick="toggleRubric()" id="btnRubricToggle">View Official Rubric</button>
<div class="rubric-panel" id="rubricPanel">
    <div class="drawer-header rubric-header">
        <h2>Official Evaluation Rubric</h2>
        <button class="close-drawer" onclick="toggleRubric()">√ó</button>
    </div>
    <div class="rubric-content">
        <div class="rubric-section">
            <h4>Part 1: Project Description & SDG</h4>
            <div class="rubric-rule">
                <p><strong>Clarity & Problem Identification (1.1 - 1.3)</strong></p>
                <p><span class="score-badge s5">5 - Highly Agree</span> Candidate effectively identifies a problem that relates to at least one SDG and offers a compelling response. Description is highly clear and uses simple language. Avoids all buzzwords.</p>
                <p><span class="score-badge s4">4 - Agree</span> Candidate identifies a problem related to at least one SDG, but with some lack of clarity. Description is clear and easy to understand.</p>
                <p><span class="score-badge s3">3 - Unsure</span> Description is generally understandable but lacks consistency in clarity. Uses some buzzwords that may confuse a non-expert.</p>
                <p><span class="score-badge s2">2 - Disagree</span> Problem statement lacks clarity or fails to address a significant issue. Description is vague or poorly structured.</p>
                <p><span class="score-badge s1">1 - Highly Disagree</span> Candidate does not clearly identify a problem. Phrases answers in future uncertainty. Heavily relies on jargon.</p>
            </div>
            
            <div class="rubric-rule">
                <p><strong>Number of Lives Impacted (1.9 & 2)</strong></p>
                <p><span class="score-badge s5">5 - Highly Agree</span> Candidate provides a specific, well-reasoned number based on concrete project plans. Demonstrates understanding of limitations.</p>
                <p><span class="score-badge s4">4 - Agree</span> Candidate provides a reasonable number with some explanation of how they arrived at it.</p>
            </div>
        </div>

        <div class="rubric-section">
            <h4>Part 2: You as a Leader</h4>
            <div class="rubric-rule">
                <p><strong>Personal Motivation (Q1)</strong></p>
                <p><span class="score-badge s5">5 - Highly Agree</span> Demonstrates a clear and compelling personal story. Clearly articulates a deep, personal "why" behind their work.</p>
                <p><span class="score-badge s3">3 - Unsure</span> Mentions personal experiences, but the link to social impact motivation is surface-level or underdeveloped.</p>
                <p><span class="score-badge s1">1 - Highly Disagree</span> Motivation is unclear or primarily focused on r√©sum√©-building or external rewards.</p>
            </div>
        </div>
    </div>
</div>

<div class="container" id="pdfContentArea">
    <div class="header">
        <div class="logo-container">
            <img src="logo.png.jpg" alt="MCN Logo" class="logo-img" id="officialLogo">
        </div>
        <h1>Admissions Reviewers Toolkit</h1>
        <p>Developed By Akhyear Mushfiqur Rahman, Millennium Fellow'25 & GAC'26</p>
    </div>

    <div class="setup-grid" id="setupGrid">
        <div class="field-group">
            <label>Applicant's Responses Datasheet Link</label>
            <input type="text" id="sheetLink" placeholder="Paste your Google Sheet link here...">
        </div>
        <div class="field-group">
            <label>Candidate Row No.</label>
            <input type="number" id="rowNum" value="2">
        </div>
        <button class="btn-primary" onclick="loadData()">Fetch</button>
        <button class="btn-download-draft" onclick="downloadDraftCSV()" id="btnDownload">Draft CSV sheet</button>
    </div>

    <div id="displayArea">
        <div class="empty-state">
            <span class="joyful-emoji">‚ú®</span>
            <h3>Ready to Discover a Changemaker!</h3>
            <p style="margin-bottom: 25px;">Start your evaluation session by following the guide below.</p>
            
            <div class="onboarding-grid">
                <div class="onboard-card">
                    <h4>üöÄ Why this toolkit?</h4>
                    <ul>
                        <li><strong>Everything in One Place:</strong> The Official Rubric, AI Policy, and Applicant Essays are all on a single screen to prevent distractions.</li>
                        <li><strong>Easy to Read:</strong> Clean text, organized layouts, and smooth scrolling help reduce eye strain during long evaluation sessions.</li>
                        <li><strong>Saves You Time:</strong> Automatic formatting and a built-in memory vault ensure you never lose a score and can copy data instantly.</li>
                    </ul>
                </div>
                <div class="onboard-card">
                    <h4>üõ†Ô∏è How to use?</h4>
                    <ol>
                        <li><strong>Paste & Fetch:</strong> Put your Master Sheet link in the top bar and select the row number you want to evaluate.</li>
                        <li><strong>Check the Rules:</strong> Use the side buttons to slide out the AI Policy and Official Rubric whenever you need them.</li>
                        <li><strong>Score the Applicant:</strong> Read the profile and fill out the 28-point assessment board at the bottom.</li>
                        <li><strong>Save your Draft:</strong> Click <em>Copy Scores to Clipboard</em> or use <em>Draft CSV Sheet</em> before you manually select the options in the official form.</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <div class="auth-suite" id="authSuite">
        <div class="auth-text">
            <h3>Authenticity Check</h3>
            <p>Instantly copy this application and open the QuillBot AI Detector.</p>
        </div>
        <button class="btn-auth" id="btnQuillbot" onclick="checkAuthenticity()">Check with QuillBot &#8599;</button>
    </div>

    <div class="nav-buttons" id="navButtons">
        <button class="nav-btn" onclick="changeRow(-1)">&#8592; Previous</button>
        <button class="nav-btn" onclick="changeRow(1)">Next &#8594;</button>
    </div>

    <div class="eval-board" id="evalBoard">
        <h3 style="margin-top:0; color:var(--mcn-navy); font-size: 26px; font-weight: 800; margin-bottom: 25px;">Final Assessment</h3>
        <div id="evalContainer"></div>
        <button class="btn-copy" onclick="copyScores()" id="btnCopyEval">Copy Scores to Clipboard</button>
        <button class="btn-draft" onclick="saveToDraft()" id="btnDraft">Export to Draft Sheet</button>
        <button class="btn-pdf" onclick="saveAsPDF()" id="btnPdf">Save Profile as PDF</button>
    </div>
</div>

<div class="footer">
    <div class="footer-credit">Developed by Akhyear Mushfiqur Rahman</div>
    <div class="footer-sub">
        Millennium Fellow '25 | GAC '26 Member | Economics major at the University of Dhaka
    </div>
    <div class="footer-links">
        <a href="https://bd.linkedin.com/in/akhyear-mushfiqur-rahman" target="_blank">üîó LinkedIn</a>
        <a href="https://www.millenniumfellows.org/fellow/2025/ud/akhyear-mushfiqur-rahman" target="_blank">üåç Millennium Fellow Profile</a>
    </div>
    <div class="footer-disclaimer">
        <strong>‚ö†Ô∏è Important Notice:</strong> This toolkit is an independent personal project and is not an officially mandated platform by the Millennium Campus Network. This tool cannot directly modify your official evaluation spreadsheet. It is designed solely to help you generate draft assessments efficiently. You will still need to manually select your final evaluations from the dropdown menus in your actual assigned assessment sheet.
    </div>
</div>

<script>
let currentFullText = "";
let currentApplicantName = "Applicant";
const evalIds = []; for(let i=1; i<=28; i++) { evalIds.push('eval_' + i); }

// Assessment Questions Array
const questions = [
    "Student is leading or involved in a social impact organization, project, creative initiative, etc.",
    "Student's description of the project is clear, accessible and easy to understand",
    "Student presents clear and specific measurable goals and activities",
    "Project demonstrates potential for sustainability and/or scalability",
    "Student‚Äôs work is genuinely connected to one or more SDGs or UNAI Principles",
    "Student‚Äôs work will offer a contribution to the Fellowship cohort",
    "Student is close to the people they are trying to help (Proximity)",
    "Political nature of project: Is the work politically sensitive?",
    "Ethics of project: Does it seem unethical or paternalistic?",
    "Q1: Personal experiences shaping interest in social impact (Story)",
    "Q2: Why become a Millennium Fellow? Future use of distinction",
    "Q3: Reflection on acting as an empathetic, humble, inclusive leader",
    "Essay/video responses demonstrate emotional investment and passion",
    "Student has a genuine passion and personal connection to the work",
    "Articulates a clear vision for future social impact career/life",
    "Motivation for joining is related to their proposed project",
    "Demonstrates real commitment to the program requirements",
    "Clear understanding and willingness to participate in all aspects",
    "Does the applicant demonstrate a community mindset?",
    "Student is driven by values (empathy/humility) over personal importance",
    "Provides specific examples of demonstrating empathy and humility",
    "Ethics of person: Do responses lead you to question their ethics?",
    "Overall, do the responses seem AI-generated? (Option 1-4)",
    "Overall, does the applicant show ethical integrity?",
    "Your Overall Rating of the Applicant (1-10)",
    "Overall, what do you think about this applicant? (Final Decision)",
    "If you selected 'Reject this Applicant', please share why",
    "[Optional] Additional comments about this application"
];

// Generate Evaluation UI
const evalCont = document.getElementById('evalContainer');
questions.forEach((q, i) => {
    const num = i + 1;
    let inputHtml = "";
    
    if (num === 23) { // AI Question
        inputHtml = `<select id="eval_${num}" class="eval-input"><option value="">Select Option...</option><option value="Option 1">Option 1: Completely AI / Unoriginal</option><option value="Option 2">Option 2: Majority AI / Original Ideas</option><option value="Option 3">Option 3: Limited AI / Original Ideas</option><option value="Option 4">Option 4: Original No AI</option></select>`;
    } else if (num === 25) { // Rating
        inputHtml = `<select id="eval_${num}" class="eval-input"><option value="">Select Rating...</option>${[10,9,8,7,6,5,4,3,2,1].map(n => `<option value="${n}">${n}</option>`).join('')}</select>`;
    } else if (num === 26) { // Decision
        inputHtml = `<select id="eval_${num}" class="eval-input"><option value="">Select Decision...</option><option value="Accept">Accept</option><option value="Waitlist">Waitlist</option><option value="Reject">Reject</option></select>`;
    } else if (num === 8 || num === 9 || num === 22 || num === 24) { // Yes/No
        inputHtml = `<select id="eval_${num}" class="eval-input"><option value="">Select...</option><option value="Yes">Yes</option><option value="Maybe">Maybe</option><option value="No">No</option></select>`;
    } else if (num >= 27) { // Text Areas
        inputHtml = `<textarea id="eval_${num}" class="eval-textarea" placeholder="Enter details..."></textarea>`;
    } else { // Standard 1-5 Score
        inputHtml = `<select id="eval_${num}" class="eval-input"><option value="">Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>`;
    }

    evalCont.innerHTML += `<div class="eval-row"><div class="eval-q-text">${num}. ${q}</div>${inputHtml}</div>`;
});

function toggleRubric() { document.getElementById('rubricPanel').classList.toggle('open'); }
function toggleAiPolicy() { document.getElementById('aiPanel').classList.toggle('open'); }

function loadData() {
    let link = document.getElementById('sheetLink').value.trim();
    const row = parseInt(document.getElementById('rowNum').value);
    const output = document.getElementById('displayArea');
    if (!link) return;
    if (link.includes('/edit')) link = link.split('/edit')[0] + '/export?format=csv';

    Papa.parse(link, {
        download: true, header: true,
        complete: function(results) {
            const data = results.data;
            const student = data[row - 2];
            if (!student) return;
            currentFullText = "";
            currentApplicantName = (student["First Name"] + "_" + student["Last Name"]).trim() || "Applicant";
            let html = "<div class='animated-entry'><h2 style='color:var(--mcn-navy); margin-bottom: 30px; font-weight: 800;'>Applicant Profile</h2>";
            for (const key in student) {
                if (student[key]) {
                    html += `<div class="impact-card"><span class="card-label">${key}</span><div class="card-value">${student[key]}</div></div>`;
                    currentFullText += key + ": " + student[key] + "\n\n";
                }
            }
            output.innerHTML = html + "</div>";
            document.getElementById('authSuite').style.display = "flex";
            document.getElementById('navButtons').style.display = "flex";
            document.getElementById('evalBoard').style.display = "block";
        }
    });
}

function checkAuthenticity() {
    navigator.clipboard.writeText(currentFullText);
    window.open('https://quillbot.com/ai-content-detector', '_blank');
}

function changeRow(step) {
    const rowBox = document.getElementById('rowNum');
    rowBox.value = Math.max(2, parseInt(rowBox.value) + step);
    loadData();
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function copyScores() {
    const vals = evalIds.map(id => document.getElementById(id).value.replace(/\n/g, " "));
    navigator.clipboard.writeText(vals.join("\t"));
    document.getElementById('btnCopyEval').innerText = "‚úì Copied as Tab-Separated Data";
    setTimeout(() => { document.getElementById('btnCopyEval').innerText = "Copy Scores to Clipboard"; }, 2000);
}

function saveToDraft() {
    const row = document.getElementById('rowNum').value;
    const vals = evalIds.map(id => document.getElementById(id).value.replace(/\n/g, " "));
    let drafts = JSON.parse(localStorage.getItem('mcn_eval_drafts')) || {};
    drafts[row] = { name: currentApplicantName, scores: vals };
    localStorage.setItem('mcn_eval_drafts', JSON.stringify(drafts));
    document.getElementById('btnDraft').innerText = "‚úì Saved to Draft Memory";
    setTimeout(() => { document.getElementById('btnDraft').innerText = "Export to Draft Sheet"; }, 2000);
}

function downloadDraftCSV() {
    let drafts = JSON.parse(localStorage.getItem('mcn_eval_drafts')) || {};
    let csv = "Row,Name," + questions.map((_,i) => "Q"+(i+1)).join(",") + "\n";
    Object.keys(drafts).sort((a,b)=>a-b).forEach(r => {
        csv += `${r},"${drafts[r].name}",` + drafts[r].scores.map(v => `"${v}"`).join(",") + "\n";
    });
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url; a.download = "MCN_Draft_Assessments.csv"; a.click();
}

function saveAsPDF() {
    const element = document.getElementById('pdfContentArea');
    html2pdf().from(element).save(currentApplicantName + "_MCN_Profile.pdf");
}
</script>

</body>
</html>
