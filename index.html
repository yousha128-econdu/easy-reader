<!DOCTYPE html>
<html>
<head>
    <title>MCN | Joyful GAC Toolkit</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --mcn-navy: #0A2342;
            --mcn-blue: #0056b3;
            --mcn-light: #f4f7fb;
            --auth-purple: #8b5cf6;
            --success-green: #10b981;
            --joyful-orange: #f59e0b;
            --white: #ffffff;
            --text-dark: #334155;
            --text-muted: #64748b;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #eef2f3 0%, #e0eafc 100%);
            margin: 0;
            padding: 40px 20px;
            color: var(--text-dark);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        .bg-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            overflow: hidden;
            pointer-events: none; 
        }
        
        .bg-shape {
            position: absolute;
            opacity: 0.05; 
            will-change: transform; 
            animation: float 20s infinite ease-in-out alternate;
        }

        .bg-shape:nth-child(1) { top: -2%; left: 5%; width: 250px; animation-delay: 0s; }
        .bg-shape:nth-child(2) { top: 15%; right: 3%; width: 300px; animation-delay: -5s; }
        .bg-shape:nth-child(3) { bottom: 5%; left: 8%; width: 220px; animation-delay: -10s; }
        .bg-shape:nth-child(4) { bottom: -5%; right: 10%; width: 280px; animation-delay: -15s; }
        .bg-shape:nth-child(5) { top: 45%; left: 25%; width: 180px; animation-delay: -7s; }
        .bg-shape:nth-child(6) { top: 55%; right: 25%; width: 160px; animation-delay: -12s; }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(30px) rotate(8deg); }
        }

        .container {
            max-width: 1050px;
            margin: 0 auto;
            background: #ffffff; 
            border-radius: 32px; 
            box-shadow: 0 20px 60px -15px rgba(0, 86, 179, 0.15);
            overflow: visible; 
            border: 1px solid rgba(255, 255, 255, 0.8);
            transition: transform 0.4s ease;
        }

        .header {
            background: linear-gradient(135deg, var(--mcn-navy) 0%, var(--mcn-blue) 100%);
            padding: 50px 20px;
            text-align: center;
            color: var(--white);
            border-bottom: 6px solid #38bdf8;
            border-radius: 32px 32px 0 0; 
        }

        .logo-container {
            background: var(--white);
            padding: 20px 40px;
            display: inline-block;
            border-radius: 24px;
            box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.15);
            margin-bottom: 25px;
            transition: transform 0.3s ease;
        }
        .logo-container:hover { transform: translateY(-5px); }
        .logo-img { max-width: 240px; height: auto; display: block; }

        .setup-grid {
            padding: 40px 45px;
            background: var(--white);
            display: grid;
            grid-template-columns: 1fr 130px 110px 150px; 
            gap: 18px;
            align-items: flex-end;
            border-bottom: 2px dashed #e2e8f0;
        }

        .field-group label { display: block; font-size: 13px; font-weight: 800; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 12px; color: var(--mcn-blue); }
        input, select { width: 100%; padding: 18px; border: 2px solid #e2e8f0; border-radius: 16px; font-size: 16px; background: #f8fafc; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-sizing: border-box; color: var(--text-dark); font-weight: 500;}
        input:focus, select:focus { border-color: #38bdf8; outline: none; background: var(--white); box-shadow: 0 0 0 5px rgba(56, 189, 248, 0.15); transform: translateY(-2px); }

        .btn-primary { background: linear-gradient(135deg, var(--mcn-blue), #38bdf8); color: var(--white); border: none; padding: 18px; border-radius: 50px; font-weight: 800; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); text-transform: uppercase; letter-spacing: 1px; width: 100%; box-shadow: 0 10px 20px -5px rgba(0, 86, 179, 0.3); }
        .btn-primary:hover { transform: translateY(-4px) scale(1.02); box-shadow: 0 15px 25px -5px rgba(0, 86, 179, 0.4); }

        .btn-download-draft { background: linear-gradient(135deg, #6366f1, #8b5cf6); color: var(--white); border: none; padding: 18px; border-radius: 50px; font-weight: 800; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); text-transform: uppercase; letter-spacing: 1px; width: 100%; box-shadow: 0 10px 20px -5px rgba(99, 102, 241, 0.3); }
        .btn-download-draft:hover { transform: translateY(-4px) scale(1.02); box-shadow: 0 15px 25px -5px rgba(99, 102, 241, 0.4); }

        #displayArea { padding: 45px; }

        @keyframes gentleFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animated-entry { animation: gentleFadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        .impact-card {
            background: var(--white);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid #f1f5f9;
            border-left: 8px solid #38bdf8;
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        .impact-card:hover { box-shadow: 0 20px 40px -10px rgba(0, 86, 179, 0.1); transform: translateX(5px); border-left-color: var(--mcn-blue); }
        
        .card-label { font-size: 16px; font-weight: 700; color: var(--mcn-navy); text-transform: none; letter-spacing: normal; line-height: 1.6; margin-bottom: 12px; display: block; border-bottom: 2px dashed #e2e8f0; padding-bottom: 10px; }
        .card-value { font-size: 17px; line-height: 1.8; color: var(--text-dark); white-space: pre-wrap; padding-top: 5px; }
        
        .card-value a { color: #38bdf8; text-decoration: none; font-weight: 700; border-bottom: 2px solid #bae6fd; transition: 0.2s; word-break: break-all; padding-bottom: 2px; }
        .card-value a:hover { color: var(--mcn-navy); border-bottom-color: var(--mcn-navy); }

        .auth-suite { background: linear-gradient(135deg, #f5f3ff, #ffffff); border-left: 8px solid var(--auth-purple); padding: 35px; border-radius: 24px; margin: 10px 45px 35px 45px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 10px 30px -10px rgba(139, 92, 246, 0.15); display: none; }
        .auth-text h3 { margin: 0 0 10px 0; color: var(--auth-purple); font-size: 22px; font-weight: 800; }
        .auth-text p { margin: 0; color: var(--text-muted); font-size: 16px; }
        .btn-auth { background: var(--auth-purple); color: var(--white); border: none; padding: 18px 28px; border-radius: 50px; font-weight: 800; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 10px 20px -5px rgba(139, 92, 246, 0.4); }
        .btn-auth:hover { background: #7c3aed; transform: translateY(-4px) scale(1.02); box-shadow: 0 15px 25px -5px rgba(139, 92, 246, 0.5); }

        .nav-buttons { display: flex; justify-content: space-between; margin: 0 45px 35px 45px; padding-top: 35px; border-top: 2px dashed #cbd5e1; display: none; }
        .nav-btn { background: var(--white); color: var(--mcn-navy); border: 2px solid #e2e8f0; padding: 16px 30px; border-radius: 50px; font-weight: 800; cursor: pointer; transition: all 0.3s ease; width: 48%; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .nav-btn:hover { background: var(--mcn-light); border-color: #cbd5e1; transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05); }

        .eval-board { background: var(--mcn-light); padding: 45px; border-radius: 32px; margin: 0 45px 45px 45px; display: none; border: 1px solid #e0e7ff; }
        
        .eval-row { background: var(--white); border: 1px solid #e2e8f0; border-radius: 16px; padding: 25px; margin-bottom: 20px; display: flex; flex-direction: column; gap: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.02); transition: 0.3s; }
        .eval-row:hover { border-color: #38bdf8; box-shadow: 0 10px 20px -5px rgba(0, 86, 179, 0.1); }
        .eval-q-text { font-size: 16px; font-weight: 700; color: var(--text-dark); line-height: 1.5; }
        .eval-input { width: 100%; max-width: 500px; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 15px; font-weight: 600; color: var(--mcn-navy); background: #f8fafc; transition: 0.3s; cursor: pointer; }
        .eval-input:focus { border-color: #38bdf8; outline: none; background: var(--white); box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.15); }
        .eval-textarea { width: 100%; height: 100px; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 15px; font-family: inherit; background: #f8fafc; transition: 0.3s; resize: vertical; }
        .eval-textarea:focus { border-color: #38bdf8; outline: none; background: var(--white); box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.15); }

        .btn-copy { background: linear-gradient(135deg, var(--success-green), #059669); color: var(--white); border: none; padding: 20px; border-radius: 50px; font-weight: 800; cursor: pointer; width: 100%; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 10px 20px -5px rgba(16, 185, 129, 0.3); margin-top: 15px; }
        .btn-copy:hover { transform: translateY(-4px) scale(1.01); box-shadow: 0 15px 25px -5px rgba(16, 185, 129, 0.4); }

        .btn-draft { background: linear-gradient(135deg, var(--joyful-orange), #d97706); color: var(--white); border: none; padding: 20px; border-radius: 50px; font-weight: 800; cursor: pointer; width: 100%; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); margin-top: 18px; box-shadow: 0 10px 20px -5px rgba(245, 158, 11, 0.3); }
        .btn-draft:hover { transform: translateY(-4px) scale(1.01); box-shadow: 0 15px 25px -5px rgba(245, 158, 11, 0.4); }
        
        .btn-pdf { background: linear-gradient(135deg, #ef4444, #dc2626); color: var(--white); border: none; padding: 20px; border-radius: 50px; font-weight: 800; cursor: pointer; width: 100%; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); margin-top: 18px; box-shadow: 0 10px 20px -5px rgba(239, 68, 68, 0.3); }
        .btn-pdf:hover { transform: translateY(-4px) scale(1.01); box-shadow: 0 15px 25px -5px rgba(239, 68, 68, 0.4); }

        .empty-state { text-align: center; padding: 100px 20px; color: var(--text-muted); }
        .empty-state h3 { font-size: 28px; color: var(--mcn-navy); margin-bottom: 15px; font-weight: 800; }
        .empty-state p { font-size: 18px; line-height: 1.6; }
        .joyful-emoji { font-size: 48px; margin-bottom: 20px; display: block; animation: gentleFadeIn 1s ease forwards; }

        /* THE RIGHT RUBRIC DRAWER */
        .btn-toggle-rubric { position: fixed; right: -5px; top: 50%; transform: translateY(-50%); background: linear-gradient(135deg, #8b5cf6, #6d28d9); color: white; padding: 15px 25px 15px 20px; border-radius: 30px 0 0 30px; border: none; font-weight: 800; font-size: 15px; cursor: pointer; box-shadow: -5px 5px 15px rgba(109, 40, 217, 0.3); z-index: 1000; transition: 0.3s; text-transform: uppercase; letter-spacing: 1px; writing-mode: vertical-rl; text-orientation: mixed; }
        .btn-toggle-rubric:hover { padding-right: 35px; background: #5b21b6; }
        .rubric-panel { position: fixed; top: 0; right: -600px; width: 550px; height: 100vh; background: #ffffff; box-shadow: -10px 0 30px rgba(0, 0, 0, 0.1); z-index: 1001; transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1); overflow-y: auto; border-left: 1px solid #e2e8f0; }
        .rubric-panel.open { right: 0; }

        /* THE LEFT AI POLICY DRAWER */
        .btn-toggle-ai { position: fixed; left: -5px; top: 50%; transform: translateY(-50%); background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 15px 20px 15px 25px; border-radius: 0 30px 30px 0; border: none; font-weight: 800; font-size: 15px; cursor: pointer; box-shadow: 5px 5px 15px rgba(217, 119, 6, 0.3); z-index: 1000; transition: 0.3s; text-transform: uppercase; letter-spacing: 1px; writing-mode: vertical-rl; text-orientation: mixed; }
        .btn-toggle-ai:hover { padding-left: 35px; background: #b45309; }
        .ai-panel { position: fixed; top: 0; left: -600px; width: 550px; height: 100vh; background: #ffffff; box-shadow: 10px 0 30px rgba(0, 0, 0, 0.1); z-index: 1001; transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1); overflow-y: auto; border-right: 1px solid #e2e8f0; }
        .ai-panel.open { left: 0; }

        /* Shared Drawer Headers & Styles */
        .drawer-header { color: white; padding: 30px; position: sticky; top: 0; z-index: 10; display: flex; justify-content: space-between; align-items: center; }
        .rubric-header { background: var(--mcn-navy); }
        .ai-header { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .drawer-header h2 { margin: 0; font-size: 20px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; }
        .close-drawer { background: none; border: none; color: white; font-size: 28px; cursor: pointer; transition: 0.2s; }
        .close-drawer:hover { color: #f87171; transform: scale(1.1); }
        
        .rubric-content { padding: 30px; color: var(--text-dark); }
        .rubric-section { margin-bottom: 30px; border-bottom: 2px dashed #e2e8f0; padding-bottom: 20px; }
        .rubric-section h4 { color: var(--mcn-blue); font-size: 18px; margin: 0 0 15px 0; text-transform: uppercase; letter-spacing: 1px; border-left: 5px solid var(--mcn-blue); padding-left: 10px; }
        
        /* Golden Highlights specifically for AI section */
        .ai-section h4 { color: #d97706; border-left-color: #f59e0b; }
        .ai-rule { border-left-color: #fde68a !important; }

        .rubric-rule { background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #e2e8f0; border-left: 4px solid #38bdf8; }
        .rubric-rule p { margin: 0 0 8px 0; font-size: 13px; line-height: 1.5; }
        
        .score-badge { font-weight: 800; padding: 3px 8px; border-radius: 4px; display: inline-block; margin-right: 8px; color: white; min-width: 65px; text-align: center; }
        .s5 { background: #10b981; } 
        .s4 { background: #34d399; } 
        .s3 { background: #fbbf24; color: #78350f; } 
        .s2 { background: #f87171; } 
        .s1 { background: #dc2626; } 
        .s-yn { background: #4f46e5; } 
    </style>
</head>
<body>

<div class="bg-shapes">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Sustainable_Development_Goal_01.svg/500px-Sustainable_Development_Goal_01.svg.png" class="bg-shape" alt="SDG 1">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/Sustainable_Development_Goal_04.svg/500px-Sustainable_Development_Goal_04.svg.png" class="bg-shape" alt="SDG 4">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Sustainable_Development_Goal_05.svg/500px-Sustainable_Development_Goal_05.svg.png" class="bg-shape" alt="SDG 5">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/22/Sustainable_Development_Goal_10.svg/500px-Sustainable_Development_Goal_10.svg.png" class="bg-shape" alt="SDG 10">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/Sustainable_Development_Goal_13.svg/500px-Sustainable_Development_Goal_13.svg.png" class="bg-shape" alt="SDG 13">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Sustainable_Development_Goal_17.svg/500px-Sustainable_Development_Goal_17.svg.png" class="bg-shape" alt="SDG 17">
</div>

<button class="btn-toggle-ai" onclick="toggleAiPolicy()" id="btnAiToggle">View AI Policy</button>
<div class="ai-panel" id="aiPanel">
    <div class="drawer-header ai-header">
        <h2>Official AI Policy Guide</h2>
        <button class="close-drawer" onclick="toggleAiPolicy()">√ó</button>
    </div>
    <div class="rubric-content">
        
        <p style="font-size: 14px; line-height: 1.6; margin-bottom: 25px; border-left: 4px solid #f59e0b; padding-left: 15px;">
            The MCN Admissions Team acknowledges that AI tools are widely accessible. This policy does not prohibit responsible use, but establishes boundaries to ensure applications reflect the applicant‚Äôs own thinking.
            <br><br>
            ‚úÖ <strong>Acceptable:</strong> Supplementary editing (correcting grammar, clarity, sentence flow, adjusting structure).<br>
            ‚ùå <strong>Prohibited:</strong> Generating substance (project ideas, constructing arguments, producing reflections).
        </p>

        <div class="rubric-section ai-section">
            <h4>Red Flags & Green Flags</h4>
            <div class="rubric-rule ai-rule">
                <p style="margin-bottom: 10px; font-weight: 800; color: var(--text-dark);">Substance vs. Language Refinement</p>
                <p><span class="score-badge" style="background:#10b981;">Green</span> Clear references to personal experiences, specific concrete details, nuance/self-awareness, natural tone variation, minor stylistic imperfections.</p>
                <p><span class="score-badge" style="background:#dc2626;">Red</span> Restatement of ideas with synonyms, overuse of broad/abstract terminology, highly polished but generic, uniform paragraph structure, lack of local context.</p>
            </div>
            <div class="rubric-rule ai-rule">
                <p style="margin-bottom: 10px; font-weight: 800; color: var(--text-dark);">Assessing Extent of AI Use</p>
                <p><span class="score-badge" style="background:#3b82f6;">Limited</span> 1-2 responses noticeably more refined, shifts in tone between sections, mostly authentic with isolated formal passages.</p>
                <p><span class="score-badge" style="background:#f59e0b;">Extensive</span> Consistently uniform tone everywhere, similar sentence rhythm throughout, multiple abstract answers.</p>
            </div>
        </div>

        <div class="rubric-section ai-section">
            <h4>Decision Framework</h4>
            <div class="rubric-rule ai-rule">
                <p style="margin-bottom: 10px;">For Question 23 (<strong>"AI Generated?"</strong>), select based on the overall pattern:</p>
                <p><strong>Option 1:</strong> Yes, completely AI-generated & ideas seem unoriginal.<br><em>(Generic, repetitive, lacking specificity)</em></p>
                <p><strong>Option 2:</strong> Yes, majority of application used AI for language, but ideas seem original.<br><em>(Clear original ideas; language uniformly polished)</em></p>
                <p><strong>Option 3:</strong> Yes, short portion used AI for language, ideas seem original.<br><em>(Strong authenticity overall with isolated polished sections)</em></p>
                <p><strong>Option 4:</strong> No, completely original without apparent use of AI.<br><em>(Consistent authentic voice and specificity)</em></p>
            </div>
        </div>

        <div class="rubric-section ai-section">
            <h4>Reference Examples</h4>
            <div class="rubric-rule ai-rule">
                <p><strong>Ex 1 (Option 1):</strong> <em>"My initiative seeks to create sustainable and transformative impact by empowering marginalized communities through innovative and scalable solutions..."</em> <br><span style="color:#64748b;">(Abstract, broad, no concrete detail)</span></p>
            </div>
            <div class="rubric-rule ai-rule">
                <p><strong>Ex 2 (Option 2):</strong> <em>"In my second year... I noticed many first-generation students struggled... I plan to create a peer mentorship network..."</em> <br><span style="color:#64748b;">(Idea is specific. If this high polish appears everywhere, it's Option 2)</span></p>
            </div>
            <div class="rubric-rule ai-rule">
                <p><strong>Ex 3 (Option 3):</strong> <em>"I started a small tutoring group... Over time it developed into a more organized peer-support network... Through this experience..."</em> <br><span style="color:#64748b;">(Rooted in personal experience, but phrasing is noticeably more polished than their typical informal tone elsewhere)</span></p>
            </div>
            <div class="rubric-rule ai-rule">
                <p><strong>Ex 4 (Option 4):</strong> <em>"When heavy rains damaged homes... We did not have a plan at first, and we made mistakes... That is why I want to create a campus response group."</em> <br><span style="color:#64748b;">(Specificity, lived experience, authentic reflection)</span></p>
            </div>
        </div>
        
        <div class="rubric-section ai-section" style="border-bottom: none;">
            <h4>Final Guidance</h4>
            <div class="rubric-rule ai-rule" style="border-left-color: #dc2626 !important;">
                <p>AI detection requires careful judgment. <strong>Polished writing alone should not be penalized, and such applications must not be rejected.</strong> The determining factor is originality.</p>
            </div>
        </div>

    </div>
</div>

<button class="btn-toggle-rubric" onclick="toggleRubric()" id="btnRubricToggle">View Official Rubric</button>
<div class="rubric-panel" id="rubricPanel">
    <div class="drawer-header rubric-header">
        <h2>Official Evaluation Rubric</h2>
        <button class="close-drawer" onclick="toggleRubric()">√ó</button>
    </div>
    <div class="rubric-content">
        <div class="rubric-section">
            <h4>Part 1: Project Description & SDG</h4>
            <div class="rubric-rule">
                <p><strong>Clarity & Problem Identification (1.1 - 1.3)</strong></p>
                <p><span class="score-badge s5">5 - Highly</span> Candidate effectively identifies a problem related to at least one SDG and offers a compelling response. Description is highly clear and uses simple language as if explaining to a friend. Avoids all buzzwords.</p>
                <p><span class="score-badge s4">4 - Agree</span> Identifies a problem related to an SDG, but with some lack of clarity. Reasonably compelling response. Mostly uses simple language; 1-2 minor technical terms allowed.</p>
                <p><span class="score-badge s3">3 - Unsure</span> Description generally understandable but lacks consistency in clarity. Uses buzzwords or technical terms that confuse a non-expert.</p>
                <p><span class="score-badge s2">2 - Disagree</span> Problem statement lacks clarity or fails to address a significant issue. Not a compelling response. Overuses jargon.</p>
                <p><span class="score-badge s1">1 - Highly</span> Fails to relate to an SDG or offers a poor response. Phrases answers in future uncertainty ("can do", "will try"). Heavily relies on jargon.</p>
            </div>
            <div class="rubric-rule">
                <p><strong>Number of Lives Impacted (1.9 & 2)</strong></p>
                <p><span class="score-badge s5">5 - Highly</span> Specific, well-reasoned number based on concrete plans and target groups. Demonstrates understanding of potential impact limitations.</p>
                <p><span class="score-badge s4">4 - Agree</span> Reasonable number with some explanation. May lack details about target groups or project reach.</p>
                <p><span class="score-badge s3">3 - Unsure</span> Expresses uncertainty or avoids giving a specific estimate. Needs guidance on quantifying impact.</p>
                <p><span class="score-badge s2">2 - Disagree</span> Unrealistic number without justification or contradicts other info in application.</p>
                <p><span class="score-badge s1">1 - Highly</span> Claims no positive impact or suggests negative consequences. Raises concerns about feasibility.</p>
            </div>
            <div class="rubric-rule">
                <p><strong>SDG & UNAI Principles (2.1 & 2.2)</strong></p>
                <p><span class="score-badge s5">5 - Highly</span> Clearly identifies specific SDG/UNAI and provides a convincing explanation directly addressing core objectives. Deep understanding.</p>
                <p><span class="score-badge s4">4 - Agree</span> Identifies relevant SDG/UNAI and makes reasonable connection, but lacks depth or specificity.</p>
                <p><span class="score-badge s3">3 - Unsure</span> Identifies connection but unsure which best aligns, or connection is vague.</p>
                <p><span class="score-badge s2">2 - Disagree</span> Identifies irrelevant SDG/UNAI or fails to explain connection. Limited understanding.</p>
                <p><span class="score-badge s1">1 - Highly</span> No connection to any SDG/UNAI. Actively rejects relevance or shows clear misunderstanding.</p>
            </div>
        </div>

        <div class="rubric-section">
            <h4>Part 1: Proximity to Issue</h4>
            <div class="rubric-rule">
                <p><strong>Community Connection (2.2)</strong></p>
                <p><span class="score-badge s5">5 - Highly</span> Strong personal connection. Actively involved as a member or through deep, impactful relationships (extensive personal stories, concrete examples).</p>
                <p><span class="score-badge s4">4 - Agree</span> Shows some connection or ongoing interactions (examples of involvement, but lacks depth or current engagement).</p>
                <p><span class="score-badge s3">3 - Unsure</span> Unclear level of connection. Vague statements, conflicting information, or no clear evidence of engagement.</p>
                <p><span class="score-badge s2">2 - Disagree</span> No clear connection. Suggests involvement was superficial or not impactful. Dismissive language.</p>
                <p><span class="score-badge s1">1 - Highly</span> No connection. Expresses biased views, lacks empathy, uses harmful stereotypes.</p>
            </div>
        </div>

        <div class="rubric-section">
            <h4>Part 2: You as a Leader</h4>
            <div class="rubric-rule">
                <p><strong>Personal Motivation (Q1)</strong></p>
                <p><span class="score-badge s5">5 - Highly</span> Clear/compelling personal story deeply connected to social issue. Articulates deep personal "why." Passion feels lived-in and authentic.</p>
                <p><span class="score-badge s4">4 - Agree</span> Explains interest sincerely. Mentions personal experiences, but link to social impact is not fully developed.</p>
                <p><span class="score-badge s3">3 - Unsure</span> States reasons showing some alignment, but personal "why" remains surface-level. Mentions irrelevant personal experiences.</p>
                <p><span class="score-badge s2">2 - Disagree</span> Reasons feel generic or vague. Motivation appears weak or unclear.</p>
                <p><span class="score-badge s1">1 - Highly</span> Motivation unclear or primarily focused on resume-building/credentials with no personal or social commitment.</p>
            </div>
            <div class="rubric-rule">
                <p><strong>MCN Values & Fellowship (Q2)</strong></p>
                <p><span class="score-badge s5">5 - Highly</span> Clear understanding of MCN mission/values. Genuine desire to contribute. Demonstrates real commitment and aligns own values.</p>
                <p><span class="score-badge s4">4 - Agree</span> Mentions values and outlines specific ways to engage. Focuses on contributing, but connection to own motivation is unclear.</p>
                <p><span class="score-badge s3">3 - Unsure</span> Mentions program, but focus is primarily on personal benefits/receiving benefits.</p>
                <p><span class="score-badge s2">2 - Disagree</span> Mentions values but plans are vague or unspecific.</p>
                <p><span class="score-badge s1">1 - Highly</span> Little to no knowledge of program values. No connection between fellowship and social impact goals.</p>
            </div>
            <div class="rubric-rule">
                <p><strong>Leadership & Teamwork (Q3)</strong></p>
                <p><span class="score-badge s5">5 - Highly</span> Detailed example of empathetic/humble/inclusive leadership. Shows genuine consideration for others. Values the "we" over the "I".</p>
                <p><span class="score-badge s4">4 - Agree</span> Mentions leadership and MCN value, but details are vague. Recognizes importance of fellowship community.</p>
                <p><span class="score-badge s3">3 - Unsure</span> Unclear if true leadership position. Actions primarily focused on achieving results or gaining recognition.</p>
                <p><span class="score-badge s2">2 - Disagree</span> Response does not reflect teamwork or collaboration. Focuses on personal gain or individual success.</p>
                <p><span class="score-badge s1">1 - Highly</span> No examples of leadership. Actions contradict MCN values. Does not lean toward teamwork.</p>
            </div>
        </div>

        <div class="rubric-section">
            <h4>Part 3: Overview Checks</h4>
            <div class="rubric-rule">
                <p><strong>Final Red Flags (Yes/Maybe/No)</strong></p>
                <p><span class="score-badge s-yn">Ethics</span> Does something lead you to question their ethics or seem paternalistic? Can you trust their instincts?</p>
                <p><span class="score-badge s-yn">Political</span> Is the work politically sensitive?</p>
                <p><span class="score-badge s-yn">Unique</span> Is this project/emotional investment very unique and extraordinary for MCN to take note of?</p>
                <p><span class="score-badge s-yn">Tech/Health</span> Using Tech for Impact (AI, robotics, apps) or Public Health project?</p>
                <p><span class="score-badge s-yn">AI Gen</span> Do the responses seem AI-generated?</p>
            </div>
        </div>
    </div>
</div>

<div class="container" id="pdfContentArea">
    
    <div class="header">
        <div class="logo-container">
            <img src="logo.png.jpg" alt="MCN Logo" class="logo-img" id="officialLogo">
        </div>
        <h1 style="margin:0; font-size: 36px; font-weight: 800; letter-spacing: -0.5px;">Admissions Reviewers Toolkit</h1>
        <p style="margin:12px 0 0; opacity: 0.95; font-weight: 700; text-transform: uppercase; letter-spacing: 3px; font-size: 14px; color: #bae6fd;">Developed by Akhyear Mushfiqur Rahman, Millennium Fellow'25</p>
    </div>

    <div class="setup-grid" id="setupGrid">
        <div class="field-group">
            <label>Applicant's Responses Datasheet Link</label>
            <input type="text" id="sheetLink" placeholder="Paste your Google Sheet link here...">
        </div>
        <div class="field-group">
            <label>Candidate Row No.</label>
            <input type="number" id="rowNum" value="2">
        </div>
        <button class="btn-primary" onclick="loadData()">Fetch</button>
        <button class="btn-download-draft" onclick="downloadDraftCSV()" id="btnDownload">Get CSV</button>
    </div>

    <div id="displayArea">
        <div class="empty-state">
            <span class="joyful-emoji">‚ú®</span>
            <h3>Ready to Discover a Changemaker!</h3>
            <p>Paste your link and select a row number above to load their incredible story.</p>
        </div>
    </div>

    <div class="auth-suite" id="authSuite">
        <div class="auth-text">
            <h3>Authenticity Check</h3>
            <p>Instantly copy this application and open the QuillBot AI Detector.</p>
        </div>
        <button class="btn-auth" id="btnQuillbot" onclick="checkAuthenticity()">Check with QuillBot &#8599;</button>
    </div>

    <div class="nav-buttons" id="navButtons">
        <button class="nav-btn" onclick="changeRow(-1)">&#8592; Previous</button>
        <button class="nav-btn" onclick="changeRow(1)">Next &#8594;</button>
    </div>

    <div class="eval-board" id="evalBoard">
        <h3 style="margin-top:0; color:var(--mcn-navy); font-size: 26px; font-weight: 800; margin-bottom: 25px;">Final Assessment</h3>
        
        <div class="eval-row">
            <div class="eval-q-text">1. Student is leading or involved in a social impact organization, project, creative initiative, social enterprise, etc.</div>
            <select id="eval_1" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">2. Student's description of the project is clear, accessible and easy to understand</div>
            <select id="eval_2" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">3. Student presents clear and specific measurable goals and activities for their project during the fellowship period</div>
            <select id="eval_3" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">4. Project demonstrates potential for sustainability and/or scalability beyond the fellowship period. This is to consider the long-term viability of the project.</div>
            <select id="eval_4" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">5. Student‚Äôs work is genuinely connected to one or more SDGs or UN Academic Impact Principles.</div>
            <select id="eval_5" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">6. Student‚Äôs work will offer a contribution to the Fellowship cohort on their campus and globally.</div>
            <select id="eval_6" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">7. Student is close to the people they are trying to help. They are part of the community they are trying to help, or have built meaningful relationships with community members, or have done through research and preparatory work to feel confident that they understand the complexities of the issues they are addressing.</div>
            <select id="eval_7" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">8. Political nature of project: Is the work this student is doing politically sensitive?</div>
            <select id="eval_8" class="eval-input"><option value="">Select Option...</option><option value="Yes">Yes</option><option value="Maybe">Maybe</option><option value="No">No</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">9. Ethics of project: Does something about the project this student is working on seem unethical? Does it work with communities in a paternalistic way? If you have any question about this please first ask your fellow team members for insight, and if it still seems unclear ask team MCN or mark it as a maybe.</div>
            <select id="eval_9" class="eval-input"><option value="">Select Option...</option><option value="Yes">Yes</option><option value="Maybe">Maybe</option><option value="No">No</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">10. Q1: What personal experiences have shaped your interest in creating social impact? In other words, why do you personally care about the issues you are working on or planning to work on? Tell us what drives you in your work. We want to hear your story</div>
            <select id="eval_10" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">11. Q2: Why do you want to be a Millennium Fellow? How will you use this distinction towards your future social impact work?</div>
            <select id="eval_11" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">12. Q3: MCN values that our community prioritizes empathetic, humble, inclusive leadership. Reflect upon your personal experience of acting as a leader, and share how you demonstrated one of these core values.</div>
            <select id="eval_12" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">13. Student‚Äôs essay/video responses are thoughtful and demonstrate emotional investment, a genuine passion for social change work.</div>
            <select id="eval_13" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">14. Student has a genuine passion for the work they are doing and are personally connected to it.</div>
            <select id="eval_14" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">15. Student articulates a clear vision for how they will integrate social impact work into their future life and/or career.</div>
            <select id="eval_15" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">16. Student‚Äôs motivation for social impact and joining the fellowship is related to their propsed project</div>
            <select id="eval_16" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">17. Student demonstrates real commitment to the Fellowship program and a desire to invest in all it will involve.</div>
            <select id="eval_17" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">18. Student demonstrates a clear understanding of the fellowship's requirements and expresses a willingness to actively participate in all aspects of the program.</div>
            <select id="eval_18" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">19. Does the applicant demonstrate a community mindset?</div>
            <select id="eval_19" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">20. Student is driven by a sense of values such as empathy and humility. (Watch out for applications that demonstrate that the student is actually driven by a desire for personal success and importance over social change)</div>
            <select id="eval_20" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">21. Student provides specific examples of how they have demonstrated empathy and humility in their past experiences.</div>
            <select id="eval_21" class="eval-input"><option value="">Select Score...</option><option value="5">5 - Highly Agree</option><option value="4">4 - Agree</option><option value="3">3 - Neutral</option><option value="2">2 - Disagree</option><option value="1">1 - Highly Disagree</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">22. Ethics of person: Does something in this student‚Äôs personal statements lead you to question their ethics? Do you feel you can‚Äôt quite trust their instincts? If you have any question about this please first ask your fellow team members for insight, and if it still seems unclear ask team MCN.</div>
            <select id="eval_22" class="eval-input"><option value="">Select Option...</option><option value="Yes">Yes</option><option value="Maybe">Maybe</option><option value="No">No</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">23. Overall, do the applicant's responses seem AI-generated?</div>
            <select id="eval_23" class="eval-input">
                <option value="">Select Option...</option>
                <option value="1. Yes, completely AI-generated / unoriginal ideas">1. Yes, completely AI-generated / unoriginal ideas</option>
                <option value="2. Yes, majority AI for language / original ideas">2. Yes, majority AI for language / original ideas</option>
                <option value="3. Yes, short portion AI for language / original ideas">3. Yes, short portion AI for language / original ideas</option>
                <option value="4. No, completely original no AI">4. No, completely original no AI</option>
            </select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">24. Overall, does the applicant show ethical integrity through their responses?</div>
            <select id="eval_24" class="eval-input"><option value="">Select Option...</option><option value="Yes">Yes</option><option value="Maybe">Maybe</option><option value="No">No</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">25. Your Overall Rating of the Applicant's Application</div>
            <select id="eval_25" class="eval-input"><option value="">Select Rating...</option><option value="10">10 - Exceptional</option><option value="9">9 - Outstanding</option><option value="8">8 - Excellent</option><option value="7">7 - Very Good</option><option value="6">6 - Good</option><option value="5">5 - Average</option><option value="4">4 - Below Average</option><option value="3">3 - Poor</option><option value="2">2 - Very Poor</option><option value="1">1 - Unacceptable</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">26. Overall, what do you think about this applicant?</div>
            <select id="eval_26" class="eval-input"><option value="">Select Final Decision...</option><option value="Accept this Applicant">Accept this Applicant</option><option value="Waitlist this Applicant">Waitlist this Applicant</option><option value="Reject this Applicant">Reject this Applicant</option></select>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">27. If you selected 'Reject this Applicant', please share below why.</div>
            <textarea id="eval_27" class="eval-textarea" placeholder="Type your reasons here..."></textarea>
        </div>
        <div class="eval-row">
            <div class="eval-q-text">28. [Optional] Do you have any comments about this application/applicant that we should keep in mind?</div>
            <textarea id="eval_28" class="eval-textarea" placeholder="Type your comments here..."></textarea>
        </div>

        <button class="btn-copy" onclick="copyScores()" id="btnCopyEval">Copy Scores to Clipboard</button>
        <button class="btn-draft" onclick="saveToDraft()" id="btnDraft">Export to Draft Sheet</button>
        <button class="btn-pdf" onclick="saveAsPDF()" id="btnPdf">Save Profile as PDF</button>
    </div>
</div>

<script>
let currentFullText = "";
let currentApplicantName = "Applicant";

// The master array matching your exact 28 columns
const evalIds = [];
for(let i=1; i<=28; i++) {
    evalIds.push('eval_' + i);
}

function toggleRubric() { document.getElementById('rubricPanel').classList.toggle('open'); }
function toggleAiPolicy() { document.getElementById('aiPanel').classList.toggle('open'); }

function loadData() {
    let link = document.getElementById('sheetLink').value.trim();
    const rowInput = document.getElementById('rowNum');
    const row = parseInt(rowInput.value);
    const output = document.getElementById('displayArea');
    
    document.getElementById('authSuite').style.display = "none";
    document.getElementById('navButtons').style.display = "none";
    document.getElementById('evalBoard').style.display = "none";

    if (!link) {
        output.innerHTML = "<div class='empty-state animated-entry' style='color:#ef4444;'><span class='joyful-emoji'>üîç</span><h3>Oops! Missing Link</h3><p>Please paste your master datasheet link first.</p></div>";
        return;
    }

    if (link.includes('/edit')) { link = link.split('/edit')[0] + '/export?format=csv'; }

    output.innerHTML = "<div class='empty-state animated-entry'><span class='joyful-emoji'>üöÄ</span><h3>Fetching Records...</h3><p>Gathering the candidate's amazing journey right now.</p></div>";

    Papa.parse(link, {
        download: true,
        header: true,
        complete: function(results) {
            const data = results.data;
            const index = row - 2;

            if (index < 0 || index >= data.length) {
                output.innerHTML = "<div class='empty-state animated-entry' style='color:#ef4444;'><span class='joyful-emoji'>üèÅ</span><h3>End of the Line!</h3><p>Candidate row does not exist. You might have finished the list!</p></div>";
                document.getElementById('navButtons').style.display = "flex";
                return;
            }

            const student = data[index];
            currentFullText = ""; 
            
            const firstName = student["First Name"] || "Unknown";
            const lastName = student["Last Name"] || "Candidate";
            currentApplicantName = (firstName + "_" + lastName).trim();

            let html = "<div class='animated-entry'><h2 style='color:var(--mcn-navy); margin-bottom: 30px; font-weight: 800; font-size: 28px;'>Applicant Profile</h2>";

            for (const key in student) {
                if (student[key] && student[key].trim() !== "") {
                    let contentText = student[key];
                    const linkFinder = /(https?:\/\/[^\s]+)/g;
                    contentText = contentText.replace(linkFinder, '<a href="$1" target="_blank" title="Click to open link">$1</a>');

                    html += `<div class="impact-card">
                                <span class="card-label">${key}</span>
                                <div class="card-value">${contentText}</div>
                             </div>`;
                    
                    currentFullText += key + ":\n" + student[key] + "\n\n";
                }
            }
            html += "</div>";
            output.innerHTML = html;
            
            document.getElementById('authSuite').style.display = "flex";
            document.getElementById('authSuite').classList.add('animated-entry');
            document.getElementById('navButtons').style.display = "flex";
            document.getElementById('navButtons').classList.add('animated-entry');
            document.getElementById('evalBoard').style.display = "block";
            document.getElementById('evalBoard').classList.add('animated-entry');
            
            document.getElementById('btnQuillbot').innerText = "Check with QuillBot \u2197";
            document.getElementById('btnCopyEval').innerText = "Copy Scores to Clipboard";
        }
    });
}

function checkAuthenticity() {
    const btn = document.getElementById('btnQuillbot');
    navigator.clipboard.writeText(currentFullText).then(() => {
        btn.innerText = "Text Copied! Opening QuillBot...";
        setTimeout(() => {
            window.open('https://quillbot.com/ai-content-detector', '_blank');
            btn.innerText = "Check with QuillBot \u2197";
        }, 1000);
    });
}

function changeRow(step) {
    const rowBox = document.getElementById('rowNum');
    let currentRow = parseInt(rowBox.value);
    let newRow = currentRow + step;
    if (newRow < 2) newRow = 2;
    rowBox.value = newRow;
    loadData();
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function copyScores() {
    const btn = document.getElementById('btnCopyEval');
    
    let values = evalIds.map(id => {
        let val = document.getElementById(id).value;
        return val.replace(/\n/g, " "); 
    });
    
    const combinedAnswers = values.join("\t");
    
    navigator.clipboard.writeText(combinedAnswers).then(() => {
        btn.innerText = "\u2713 Saved! Paste directly into your Sheet row";
        btn.style.background = "linear-gradient(135deg, #059669, #047857)"; 
        setTimeout(() => {
            btn.innerText = "Copy Scores to Clipboard";
            btn.style.background = "linear-gradient(135deg, var(--success-green), #059669)";
        }, 3000);
    });
}

function saveToDraft() {
    const row = document.getElementById('rowNum').value;
    const btn = document.getElementById('btnDraft');

    let values = evalIds.map(id => document.getElementById(id).value.replace(/\n/g, " "));
    let drafts = JSON.parse(localStorage.getItem('mcn_eval_drafts')) || {};

    drafts[row] = { name: currentApplicantName, scores: values };
    localStorage.setItem('mcn_eval_drafts', JSON.stringify(drafts));

    btn.innerText = "\u2713 Added to Draft Memory!";
    btn.style.background = "linear-gradient(135deg, #d97706, #b45309)"; 
    
    setTimeout(() => {
        btn.innerText = "Export to Draft Sheet";
        btn.style.background = "linear-gradient(135deg, var(--joyful-orange), #d97706)";
    }, 2500);
}

function downloadDraftCSV() {
    let drafts = JSON.parse(localStorage.getItem('mcn_eval_drafts')) || {};
    let rows = Object.keys(drafts).sort((a, b) => parseInt(a) - parseInt(b));

    if (rows.length === 0) {
        alert("You have not saved any drafts yet! Evaluate a student and click 'Export to Draft Sheet' first.");
        return;
    }

    let headers = "Row Number,Applicant Name," + Array.from({length: 28}, (_, i) => `Q${i+1}`).join(",") + "\n";
    let csvContent = headers;

    rows.forEach(row => {
        let d = drafts[row];
        let rowData = d.scores.map(v => `"${v}"`).join(",");
        csvContent += `${row},"${d.name}",${rowData}\n`;
    });

    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    const url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", "MCN_Evaluations_Draft.csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

function saveAsPDF() {
    const btnPdf = document.getElementById('btnPdf');
    btnPdf.innerText = "Scanning Document... Please Wait";
    
    document.getElementById('setupGrid').style.display = 'none';
    document.getElementById('authSuite').style.display = 'none';
    document.getElementById('navButtons').style.display = 'none';
    document.getElementById('btnCopyEval').style.display = 'none';
    document.getElementById('btnDraft').style.display = 'none';
    document.getElementById('btnRubricToggle').style.display = 'none';
    document.getElementById('btnAiToggle').style.display = 'none';
    btnPdf.style.display = 'none';

    document.getElementById('rubricPanel').classList.remove('open');
    document.getElementById('aiPanel').classList.remove('open');

    const element = document.getElementById('pdfContentArea');
    const originalBackground = element.style.background;
    const originalBackdrop = element.style.backdropFilter;
    const originalShadow = element.style.boxShadow;
    const originalBorder = element.style.border;
    
    element.style.background = '#ffffff'; 
    element.style.backdropFilter = 'none'; 
    element.style.boxShadow = 'none'; 
    element.style.border = 'none';

    const opt = {
        margin:       0.3,
        filename:     currentApplicantName + '_MCN_Evaluation.pdf',
        image:        { type: 'jpeg', quality: 1.0 },
        html2canvas:  { scale: 2, scrollY: 0, imageTimeout: 15000 },
        jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
    };

    html2pdf().set(opt).from(element).save().then(() => {
        element.style.background = originalBackground;
        element.style.backdropFilter = originalBackdrop;
        element.style.boxShadow = originalShadow;
        element.style.border = originalBorder;

        document.getElementById('setupGrid').style.display = 'grid';
        document.getElementById('authSuite').style.display = 'flex';
        document.getElementById('navButtons').style.display = 'flex';
        document.getElementById('btnCopyEval').style.display = 'block';
        document.getElementById('btnDraft').style.display = 'block';
        document.getElementById('btnRubricToggle').style.display = 'block';
        document.getElementById('btnAiToggle').style.display = 'block';
        btnPdf.style.display = 'block';
        btnPdf.innerText = "Save Profile as PDF";
    });
}
</script>

</body>
</html>
