<!DOCTYPE html>
<html>
<head>
    <title>GAC Evaluation Portal | Millennium Fellowship</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        :root { --mcn-navy: #0A2342; --mcn-blue: #0056b3; --sdg-gold: #f39200; }
        body { font-family: 'Segoe UI', sans-serif; background-color: #f0f4f8; margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: #ffffff; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; border-top: 10px solid var(--mcn-blue); }
        .header { background: var(--mcn-navy); color: white; padding: 30px; text-align: center; }
        .logo { max-width: 200px; margin-bottom: 15px; }
        .setup-section { padding: 20px; background: #f8f9fa; border-bottom: 2px solid #e9ecef; display: grid; grid-template-columns: 2fr 1fr auto; gap: 15px; align-items: end; }
        .input-group label { display: block; font-weight: bold; margin-bottom: 5px; color: var(--mcn-navy); font-size: 13px; }
        input, select { width: 100%; padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; font-size: 14px; box-sizing: border-box; }
        button { background-color: var(--mcn-blue); color: white; border: none; padding: 10px 20px; border-radius: 6px; font-weight: bold; cursor: pointer; }
        button:hover { background-color: var(--mcn-navy); }
        
        #displayArea { padding: 30px; }
        .impact-card { background: #fff; border-left: 5px solid var(--mcn-blue); margin-bottom: 20px; padding: 15px; border-radius: 0 8px 8px 0; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .label { font-size: 11px; text-transform: uppercase; color: #718096; font-weight: 800; }
        .content { font-size: 16px; margin-top: 5px; line-height: 1.6; color: #2d3748; white-space: pre-wrap; }
        
        /* New Review Section Styles */
        .review-section { background: #eef2f7; padding: 30px; border-top: 3px solid var(--mcn-blue); }
        .review-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .copy-btn { background-color: #28a745; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <img src="https://images.squarespace-cdn.com/content/v1/59404077d2b857790807755e/1501793755353-7O6F8STH7831KCPJ2M9H/Millennium+Fellowship+Logo+White.png" alt="Logo" class="logo">
        <p style="margin:0; opacity: 0.8; letter-spacing: 1px; font-size: 12px;">GLOBAL ADMISSIONS COMMITTEE PORTAL</p>
    </div>

    <div class="setup-section">
        <div class="input-group">
            <label>Secure CSV Link</label>
            <input type="text" id="sheetLink" placeholder="Paste &output=csv link...">
        </div>
        <div class="input-group">
            <label>Row Number</label>
            <input type="number" id="rowNum" value="2">
        </div>
        <button onclick="loadData()">LOAD PROFILE</button>
    </div>

    <div id="displayArea">
        <p style="text-align:center; color: #a0aec0;">Enter data above to begin your evaluation.</p>
    </div>

    <div class="review-section" id="reviewBox" style="display:none;">
        <h3 style="color:var(--mcn-navy); margin-top:0;">Evaluation Rubric</h3>
        <div class="review-grid">
            <div class="input-group">
                <label>Proximity to Issue (1-5)</label>
                <select id="evalProximity">
                    <option value="1">1 - Distant</option>
                    <option value="2">2 - Aware</option>
                    <option value="3">3 - Connected</option>
                    <option value="4">4 - Involved</option>
                    <option value="5" selected>5 - Direct Lived Experience</option>
                </select>
            </div>
            <div class="input-group">
                <label>Leadership Potential</label>
                <select id="evalLeadership">
                    <option value="Emerging">Emerging</option>
                    <option value="Strong" selected>Strong</option>
                    <option value="Exceptional">Exceptional</option>
                </select>
            </div>
            <div class="input-group">
                <label>Final Decision</label>
                <select id="evalDecision">
                    <option value="Yes">Yes (Highly Recommend)</option>
                    <option value="Maybe">Maybe (Waitlist)</option>
                    <option value="No">No (Decline)</option>
                </select>
            </div>
            <div class="input-group">
                <label>Brief Comments</label>
                <input type="text" id="evalNotes" placeholder="Why this candidate?">
            </div>
        </div>
        <button class="copy-btn" onclick="copyReview()">COPY EVALUATION FOR SHEET</button>
        <p id="copyStatus" style="font-size:12px; color: #28a745; margin-top:5px;"></p>
    </div>
</div>

<script>
function loadData() {
    const link = document.getElementById('sheetLink').value.trim();
    const row = document.getElementById('rowNum').value;
    const output = document.getElementById('displayArea');
    const reviewBox = document.getElementById('reviewBox');

    Papa.parse(link, {
        download: true, header: true,
        complete: function(results) {
            const data = results.data;
            const index = row - 2;
            if (index < 0 || index >= data.length) {
                output.innerHTML = "<p style='color:red;'>Row not found.</p>";
                return;
            }
            const student = data[index];
            let html = "<h3 style='color:var(--mcn-navy);'>Candidate Profile</h3>";
            for (const key in student) {
                if (student[key] && student[key].trim() !== "") {
                    html += `<div class="impact-card"><span class="label">${key}</span><div class="content">${student[key]}</div></div>`;
                }
            }
            output.innerHTML = html;
            reviewBox.style.display = "block"; // Show the review box
        }
    });
}

function copyReview() {
    const prox = document.getElementById('evalProximity').value;
    const lead = document.getElementById('evalLeadership').value;
    const dec = document.getElementById('evalDecision').value;
    const notes = document.getElementById('evalNotes').value;
    
    // Formats it so you can paste it into one cell or across cells
    const fullReview = `${prox} | ${lead} | ${dec} | ${notes}`;
    
    navigator.clipboard.writeText(fullReview).then(() => {
        document.getElementById('copyStatus').innerText = "Evaluation Copied! Paste it into your Google Sheet.";
        setTimeout(() => { document.getElementById('copyStatus').innerText = ""; }, 3000);
    });
}
</script>

</body>
</html>
